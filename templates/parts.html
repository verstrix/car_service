{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Инвентар на части</h3>
  {% if current_user.role == 'manager' %}
    <button class="btn btn-sm btn-primary" data-bs-toggle="collapse" data-bs-target="#addPartForm">
      Добави част
    </button>
  {% endif %}
</div>

{% if current_user.role == 'manager' %}
<div class="collapse mb-3" id="addPartForm">
  <div class="card card-body">
    <form method="post">
      <div class="row g-2">
        <div class="col-md-3">
          <input class="form-control" name="part_number" placeholder="Номер на част" required>
        </div>
        <div class="col-md-3">
          <input class="form-control" name="name" placeholder="Име" required>
        </div>
        <div class="col-md-3">
          <input class="form-control" name="quantity" placeholder="Количество" type="number">
        </div>
        <div class="col-md-3">
          <input class="form-control" name="unit_price" placeholder="Цена за брой" type="number" step="0.01">
        </div>
        <div class="col-12 mt-2">
          <textarea class="form-control" name="description" placeholder="Описание"></textarea>
        </div>
      </div>
      <button class="btn btn-success mt-3" type="submit">Запази</button>
    </form>
  </div>
</div>
{% endif %}

<div class="card">
  <div class="card-body p-0">
    <table class="table table-hover table-striped mb-0">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Част №</th>
          <th>Име</th>
          <th>Кол-во</th>
          <th>Цена</th>
        </tr>
      </thead>
      <tbody>
        {% for part in parts %}
          <tr>
            <td>{{ part.id }}</td>
            <td>{{ part.part_number }}</td>
            <td>{{ part.name }}</td>
            <td>{{ part.quantity }}</td>
            <td>{{ "%.2f"|format(part.unit_price) }}</td>
            {% if current_user.role == 'manager' %}
              <td>
                <form method="post" action="{{ url_for('parts.delete_part', part_id=part.id) }}" onsubmit="return confirm('Наистина ли искате да изтриете тази част?');">
                  <button class="btn btn-sm btn-danger">Delete</button>
                </form>
              </td>
            {% endif %}
          </tr>
        {% else %}
          <tr>
            <td colspan="6" class="text-center">Няма намерени части.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
